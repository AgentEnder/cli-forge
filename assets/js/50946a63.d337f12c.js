"use strict";(self.webpackChunk_cli_forge_docs_site=self.webpackChunk_cli_forge_docs_site||[]).push([[6553],{31121:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>N,contentTitle:()=>k,default:()=>E,frontMatter:()=>L,metadata:()=>S,toc:()=>A});var s=t(62540),i=t(43023),o=t(63696),r=t(11750),a=t(81372),l=t(49519),c=t(14395),d=t(95033),h=t(61718),u=t(52779);function m(e){return o.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,o.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:t}=e;return(0,o.useMemo)((()=>{const e=n??function(e){return m(e).map((e=>{let{props:{value:n,label:t,attributes:s,default:i}}=e;return{value:n,label:t,attributes:s,default:i}}))}(t);return function(e){const n=(0,h.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function g(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function x(e){let{queryString:n=!1,groupId:t}=e;const s=(0,l.W6)(),i=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,d.aZ)(i),(0,o.useCallback)((e=>{if(!i)return;const n=new URLSearchParams(s.location.search);n.set(i,e),s.replace({...s.location,search:n.toString()})}),[i,s])]}function j(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,i=p(e),[r,a]=(0,o.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!g({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const s=t.find((e=>e.default))??t[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:n,tabValues:i}))),[l,d]=x({queryString:t,groupId:s}),[h,m]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[s,i]=(0,u.Dv)(t);return[s,(0,o.useCallback)((e=>{t&&i.set(e)}),[t,i])]}({groupId:s}),j=(()=>{const e=l??h;return g({value:e,tabValues:i})?e:null})();(0,c.A)((()=>{j&&a(j)}),[j]);return{selectedValue:r,selectValue:(0,o.useCallback)((e=>{if(!g({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);a(e),d(e),m(e)}),[d,m,i]),tabValues:i}}var f=t(86681);const y={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function b(e){let{className:n,block:t,selectedValue:i,selectValue:o,tabValues:l}=e;const c=[],{blockElementScrollPositionUntilNextRender:d}=(0,a.a_)(),h=e=>{const n=e.currentTarget,t=c.indexOf(n),s=l[t].value;s!==i&&(d(n),o(s))},u=e=>{let n=null;switch(e.key){case"Enter":h(e);break;case"ArrowRight":{const t=c.indexOf(e.currentTarget)+1;n=c[t]??c[0];break}case"ArrowLeft":{const t=c.indexOf(e.currentTarget)-1;n=c[t]??c[c.length-1];break}}n?.focus()};return(0,s.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":t},n),children:l.map((e=>{let{value:n,label:t,attributes:o}=e;return(0,s.jsx)("li",{role:"tab",tabIndex:i===n?0:-1,"aria-selected":i===n,ref:e=>c.push(e),onKeyDown:u,onClick:h,...o,className:(0,r.A)("tabs__item",y.tabItem,o?.className,{"tabs__item--active":i===n}),children:t??n},n)}))})}function w(e){let{lazy:n,children:t,selectedValue:i}=e;const a=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=a.find((e=>e.props.value===i));return e?(0,o.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,s.jsx)("div",{className:"margin-top--md",children:a.map(((e,n)=>(0,o.cloneElement)(e,{key:n,hidden:e.props.value!==i})))})}function v(e){const n=j(e);return(0,s.jsxs)("div",{className:(0,r.A)("tabs-container",y.tabList),children:[(0,s.jsx)(b,{...n,...e}),(0,s.jsx)(w,{...n,...e})]})}function I(e){const n=(0,f.A)();return(0,s.jsx)(v,{...e,children:m(e.children)},String(n))}const C={tabItem:"tabItem_Ymn6"};function T(e){let{children:n,hidden:t,className:i}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,r.A)(C.tabItem,i),hidden:t,children:n})}const L={},k="Getting Started with CLI Forge",S={id:"guides/quick-start",title:"Getting Started with CLI Forge",description:"As CLI Forge is focused on first class TypeScript support, this guide will assume you are using TypeScript. If you are not using TypeScript, you can still use CLI Forge, and can pass --format js to the cli-forge init command when getting started. The runtime functionality of your CLI will not be affected by this choice, but you will lose out on the type safety and intellisense that TypeScript provides.",source:"@site/docs/guides/quick-start.md",sourceDirName:"guides",slug:"/guides/quick-start",permalink:"/cli-forge/guides/quick-start",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Autogenerate CLI Documentation",permalink:"/cli-forge/guides/generate-docs"},next:{title:"TypeScript Configuration and Setup",permalink:"/cli-forge/guides/typescript"}},N={},A=[{value:"Manual Installation",id:"manual-installation",level:2},{value:"Automatic Installation (cli-forge init)",id:"automatic-installation-cli-forge-init",level:2},{value:"Writing Your First Command",id:"writing-your-first-command",level:2},{value:"Invoking Your CLI",id:"invoking-your-cli",level:2},{value:"The Interactive Shell",id:"the-interactive-shell",level:2},{value:"Adding Options",id:"adding-options",level:2},{value:"Adding Subcommands",id:"adding-subcommands",level:2},{value:"Testing Your CLI",id:"testing-your-cli",level:2},{value:"Manual Testing",id:"manual-testing",level:3},{value:"Automated Testing (Unit Tests)",id:"automated-testing-unit-tests",level:3},{value:"Automated Testing (End-to-End Tests)",id:"automated-testing-end-to-end-tests",level:3}];function q(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"getting-started-with-cli-forge",children:"Getting Started with CLI Forge"})}),"\n",(0,s.jsxs)(n.p,{children:["As CLI Forge is focused on first class TypeScript support, this guide will assume you are using TypeScript. If you are not using TypeScript, you can still use CLI Forge, and can pass ",(0,s.jsx)(n.code,{children:"--format js"})," to the ",(0,s.jsx)(n.code,{children:"cli-forge init"})," command when getting started. The runtime functionality of your CLI will not be affected by this choice, but you will lose out on the type safety and intellisense that TypeScript provides."]}),"\n",(0,s.jsx)(n.h2,{id:"manual-installation",children:"Manual Installation"}),"\n",(0,s.jsx)(n.p,{children:"If adding a cli to an existing project, you may wish to install CLI Forge with npm or yarn:"}),"\n",(0,s.jsxs)(I,{children:[(0,s.jsx)(T,{value:"npm",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install cli-forge\n"})})}),(0,s.jsx)(T,{value:"yarn",label:"Yarn",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"yarn add cli-forge\n"})})}),(0,s.jsx)(T,{value:"pnpm",label:"pnpm",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"pnpm add cli-forge\n"})})})]}),"\n",(0,s.jsx)(n.h2,{id:"automatic-installation-cli-forge-init",children:"Automatic Installation (cli-forge init)"}),"\n",(0,s.jsx)(n.p,{children:"To get started with a new CLI project, run the following command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npx cli-forge init my-cli\n"})}),"\n",(0,s.jsxs)(n.p,{children:["This will create a new directory called ",(0,s.jsx)(n.code,{children:"my-cli"})," with the following structure:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"my-cli/\n\u251c\u2500\u2500 bin/\n\u2502   \u2514\u2500\u2500 my-cli.ts\n\u251c\u2500\u2500 scripts/\n\u2502   \u2514\u2500\u2500 build.ts\n\u251c\u2500\u2500 package.json\n\u251c\u2500\u2500 tsconfig.json\n\u2514\u2500\u2500 README.md\n"})}),"\n",(0,s.jsx)(n.p,{children:"Lets take a closer look at each of these files:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"bin/my-cli.ts"})," acts as the entry point for your CLI. You can start adding commands and options to it right away."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"scripts/build.ts"})," file is a helper script that will compile your CLI using typescript. You can run this script with ",(0,s.jsx)(n.code,{children:"npx tsx scripts/build.ts"}),", or via the npm script we added via ",(0,s.jsx)(n.code,{children:"npm run build"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["This script invokes ",(0,s.jsx)(n.code,{children:"tsc"}),", and copies the ",(0,s.jsx)(n.code,{children:"package.json"})," file to the ",(0,s.jsx)(n.code,{children:"dist"})," directory. This is done to ensure that the ",(0,s.jsx)(n.code,{children:"package.json"})," file is included in the final package when publishing to npm."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"package.json"})," file contains the metadata for your CLI. You can add dependencies, scripts, and other metadata to this file."]}),"\n",(0,s.jsxs)(n.p,{children:["Let's take a closer look at each of the important sections in the ",(0,s.jsx)(n.code,{children:"package.json"})," file:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"name"}),": The name of your CLI. This should be a unique name on npm."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"bin"}),": Describes the CLI commands made available by your package. By default, this will be set to ",(0,s.jsx)(n.code,{children:'{"my-cli": "./bin/my-cli"}'}),". This enables running your CLI via ",(0,s.jsx)(n.code,{children:"npx my-cli"})," or ",(0,s.jsx)(n.code,{children:"my-cli"})," inside of an npm script. For ",(0,s.jsx)(n.code,{children:"npx"})," to work directly, the ",(0,s.jsx)(n.code,{children:"bin"})," entry should match the name of the package. If it doesn't, you can use ",(0,s.jsx)(n.code,{children:"npx -p {package-name} {command}"})," to run the CLI."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"dependencies"}),": A list of dependencies that your CLI depends on. This list will be installed when someone installs your CLI via npm, or when they use ",(0,s.jsx)(n.code,{children:"npx"})," to run your CLI. As such, its a good idea to keep this list as small as possible. ",(0,s.jsx)(n.code,{children:"cli-forge"})," is the only direct dependency that is required when using CLI Forge."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"devDependencies"}),": These are dependencies that are only needed during development. ",(0,s.jsx)(n.code,{children:"markdown-factory"})," will be added as a dev dependency to generate documentation for your CLI. It can be removed if you don't wish to generate documentation. By default when using ",(0,s.jsx)(n.code,{children:"typescript"})," this list will contain the following packages:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"typescript"}),": The typescript compiler."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"tsx"}),": A typescript loader that allows you to import typescript files without needing to compile them first."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"@tsconfig/node-lts"}),": A typescript configuration that is optimized for node.js development."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"tsconfig.json"}),": The typescript configuration file for your CLI. This file is used by the typescript compiler to determine how to compile your typescript files. By default, this file will extend the ",(0,s.jsx)(n.code,{children:"@tsconfig/node-lts"})," configuration, which is optimized for node.js development, and setup building to a ",(0,s.jsx)(n.code,{children:"dist"})," directory."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"writing-your-first-command",children:"Writing Your First Command"}),"\n",(0,s.jsxs)(n.p,{children:["Let's examine the ",(0,s.jsx)(n.code,{children:"bin/my-cli.ts"})," file that was generated for you:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { cli } from 'cli-forge';\n\nconst myCLI = cli('my-cli').command('hello', {\n  builder: (args) => args.positional('name', { type: 'string' }),\n  handler: (args) => {\n    console.log('hello', args.name);\n  },\n});\n\nexport default myCLI;\n\nif (require.main === module) {\n  myCLI.forge();\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"This file is doing a few interesting things:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"cli"})," function bootstraps a new CLI instance. This instance represents the root command of your CLI."]}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"command"})," function adds a new command to the CLI. This function takes a name and an options object. The options object contains a ",(0,s.jsx)(n.code,{children:"builder"})," function that defines the arguments and options for the command, and a ",(0,s.jsx)(n.code,{children:"handler"})," function that is called when the command is executed."]}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"builder"})," function is used to define the arguments and options for the command. In this case, we are defining a single positional argument called ",(0,s.jsx)(n.code,{children:"name"})," that is of type ",(0,s.jsx)(n.code,{children:"string"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"handler"})," function is called when the command is executed. In this case, we are logging ",(0,s.jsx)(n.code,{children:"hello"})," followed by the ",(0,s.jsx)(n.code,{children:"name"})," argument to the console."]}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"export default myCLI"})," line exports the CLI instance so that it can be used by the CLI Forge CLI to generate documentation."]}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"if (require.main === module)"})," block ensures that the CLI is only executed when run directly via ",(0,s.jsx)(n.code,{children:"npx my-cli"})," or ",(0,s.jsx)(n.code,{children:"my-cli"}),". This is done to prevent the CLI from running when the file is imported as a module (e.g. when generating documentation)."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["We can customize this to add a new command called ",(0,s.jsx)(n.code,{children:"goodbye"})," that takes an optional ",(0,s.jsx)(n.code,{children:"name"})," argument:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { cli } from 'cli-forge';\n\nconst myCLI = cli('my-cli')\n  .command('hello', {\n    builder: (args) => args.positional('name', { type: 'string' }),\n    handler: (args) => {\n      console.log('hello', args.name);\n    },\n  })\n  .command('goodbye', {\n    builder: (args) => args.positional('name', { type: 'string', default: 'world' }),\n    handler: (args) => {\n      console.log('goodbye', args.name);\n    },\n  });\n\nexport default myCLI;\n\nif (require.main === module) {\n  myCLI.forge();\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"invoking-your-cli",children:"Invoking Your CLI"}),"\n",(0,s.jsxs)(n.p,{children:["To run your CLI without building it, you can use ",(0,s.jsx)(n.a,{href:"https://npmjs.com/tsx",children:(0,s.jsx)(n.code,{children:"tsx"})}),". If you'd rather build your CLI first, you can run ",(0,s.jsx)(n.code,{children:"npm run build"})," to compile your typescript files to javascript."]}),"\n",(0,s.jsxs)(I,{children:[(0,s.jsx)(T,{value:"TypeScript + TSX",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npx tsx bin/my-cli.ts hello --name world\n"})})}),(0,s.jsx)(T,{value:"TypeScript + Build",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm run build\nnpx bin/my-cli hello --name world\n"})})})]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," Future commands will only show the ",(0,s.jsx)(n.code,{children:"tsx"})," variant of the CLI invocation. If you wish to see the ",(0,s.jsx)(n.code,{children:"npm run build"})," variant, you can refer back to this section."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Let's try running the cli without providing a command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npx tsx bin/my-cli.ts\n"})}),"\n",(0,s.jsx)(n.p,{children:"Woah! The CLI threw an error:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"Error: my-cli requires a command\n    at InternalCLI.runCommand (/Users/agentender/repos/cli-forge/tmp/e2e/default/packages/cli-forge/src/lib/internal-cli.ts:314:15)\n    at <anonymous> (/Users/agentender/repos/cli-forge/tmp/e2e/default/packages/cli-forge/src/lib/internal-cli.ts:492:18)\n    at InternalCLI.withErrorHandlers (/Users/agentender/repos/cli-forge/tmp/e2e/default/packages/cli-forge/src/lib/internal-cli.ts:389:20)\n    at InternalCLI.forge (/Users/agentender/repos/cli-forge/tmp/e2e/default/packages/cli-forge/src/lib/internal-cli.ts:451:10)\n    at <anonymous> (/Users/agentender/repos/cli-forge/tmp/e2e/default/my-cli/bin/my-cli.ts:14:9)\n    at Object.<anonymous> (/Users/agentender/repos/cli-forge/tmp/e2e/default/my-cli/bin/my-cli.ts:15:1)\n    at Module._compile (node:internal/modules/cjs/loader:1467:14)\n    at Object.transformer (/Users/agentender/repos/cli-forge/tmp/e2e/default/my-cli/node_modules/tsx/dist/register-C1urN2EO.cjs:2:1122)\n    at Module.load (node:internal/modules/cjs/loader:1282:32)\n    at Module._load (node:internal/modules/cjs/loader:1098:12)\nUsage: my-cli\n\nCommands:\n  hello\n\nOptions:\n  --help    - Show help for the current command\n  --version - Show the version number for the CLI\n\nRun `my-cli [command] --help` for more information on a command\n"})}),"\n",(0,s.jsx)(n.p,{children:"Disecting the error message, it has two parts:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The first part is the error message itself: ",(0,s.jsx)(n.code,{children:"my-cli requires a command"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"The second part is the help message that is displayed when the CLI errors."}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The help message shows the available commands and options for the CLI. In this case, the CLI has a single command called ",(0,s.jsx)(n.code,{children:"hello"}),", and two options: ",(0,s.jsx)(n.code,{children:"--help"})," and ",(0,s.jsx)(n.code,{children:"--version"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Our CLI requires a command to be provided because all of the following are true:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"cli"})," instance was created without options for the root command."]}),"\n",(0,s.jsxs)(n.li,{children:["No root commamnd was added via ",(0,s.jsx)(n.code,{children:".command($0, ...)"})]}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:".enableInteractiveShell"})," method was not called on the ",(0,s.jsx)(n.code,{children:"cli"})," instance."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Note, registering the root command can be done by either providing options to the ",(0,s.jsx)(n.code,{children:"cli"})," function or by adding a command via ",(0,s.jsx)(n.code,{children:".command($0, ...)"}),". The result is equivalent."]}),"\n",(0,s.jsx)(n.h2,{id:"the-interactive-shell",children:"The Interactive Shell"}),"\n",(0,s.jsx)(n.p,{children:"The interactive shell is a feature of CLI Forge that allows you to run your CLI in an interactive mode. This mode is useful for users which will run your CLI multiple times with different arguments, or for users who are not familiar with the CLI and want to explore the available commands and options."}),"\n",(0,s.jsxs)(n.p,{children:["To enable the interactive shell, you can call the ",(0,s.jsx)(n.code,{children:".enableInteractiveShell"})," method on the ",(0,s.jsx)(n.code,{children:"cli"})," instance:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { cli } from 'cli-forge';\n\nconst myCLI = cli('my-cli')\n  .enableInteractiveShell()\n  .command('hello', {\n    builder: (args) => args.positional('name', { type: 'string' }),\n    handler: (args) => {\n      console.log('hello', args.name);\n    },\n  })\n  .command('goodbye', {\n    builder: (args) => args.positional('name', { type: 'string', default: 'world' }),\n    handler: (args) => {\n      console.log('goodbye', args.name);\n    },\n  });\n\nexport default myCLI;\n\nif (require.main === module) {\n  myCLI.forge();\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Now, when you run the CLI without providing a command, the interactive shell will be started:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npx tsx bin/my-cli.ts\n\nmy-cli >\n"})}),"\n",(0,s.jsxs)(n.p,{children:["From here, you can type ",(0,s.jsx)(n.code,{children:"help"})," to see the available commands and options, or type ",(0,s.jsx)(n.code,{children:"exit"})," to exit the interactive shell."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"my-cli > help\n\nUsage: my-cli\n\nCommands:\n  hello\n  goodbye\n\nOptions:\n  --help    - Show help for the current command\n  --version - Show the version number for the CLI\n"})}),"\n",(0,s.jsxs)(n.p,{children:["You can run the ",(0,s.jsx)(n.code,{children:"hello"})," and ",(0,s.jsx)(n.code,{children:"goodbye"})," commands as you would normally:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"\nmy-cli > hello world\nhello world\n\n> my-cli > goodbye earth\ngoodbye earth\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Note that the interactive shell is completely optional, and may not be suitable for all CLIs. If you don't want to use the interactive shell, you can remove the ",(0,s.jsx)(n.code,{children:".enableInteractiveShell"})," call from your CLI."]}),"\n",(0,s.jsx)(n.h2,{id:"adding-options",children:"Adding Options"}),"\n",(0,s.jsxs)(n.p,{children:["Options are additional flags that can be passed to a command. They can be either boolean flags (e.g. ",(0,s.jsx)(n.code,{children:"--verbose"}),"), or flags that take a value (e.g. ",(0,s.jsx)(n.code,{children:"--output-file file.txt"}),"). CLI Forge supports several types of options out of the box, including:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"string"}),": A string value. (e.g. ",(0,s.jsx)(n.code,{children:"--name john"}),")"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"number"}),": A number value. (e.g. ",(0,s.jsx)(n.code,{children:"--count 42"}),")"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"boolean"}),": A boolean value. (e.g. ",(0,s.jsx)(n.code,{children:"--verbose"}),", ",(0,s.jsx)(n.code,{children:"--verbose true"}),", ",(0,s.jsx)(n.code,{children:"--no-verbose"}),")"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"array"}),": An array of values."]}),"\n",(0,s.jsx)(n.p,{children:"Arrays accept either numbers or strings for their items. They can be passed in 3 ways:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"--array 1 2 3"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"--array 1,2,3"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"--array 1 --array 2 --array 3"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"object"}),": An object value."]}),"\n",(0,s.jsx)(n.p,{children:"Objects are the most complex type of option, and should be used sparingly. They are passed in via dot-notation:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"--object.key value"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"--object.key1 value1 --object.key2 value2"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Nested objects are supported, and would look like this:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"--object.key1.key2 value"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Let's add a few options to the ",(0,s.jsx)(n.code,{children:"hello"})," command:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"const myCLI = cli('my-cli').command('hello', {\n  builder: (args) =>\n    args\n      .positional('people', { type: 'array', items: 'string' })\n      .option('newline', {\n        type: 'boolean',\n        description: 'Print greetings on separate lines',\n      })\n      .option('repeat', {\n        type: 'number',\n        description: 'Repeat the name n times',\n        default: 1,\n      }),\n  handler: (args) => {\n    const parts = ['hello'];\n    const names = args.people.join(args.newline ? '\\n' : ', ');\n    console.log('hello', names.repeat(args.repeat));\n  },\n});\n"})}),"\n",(0,s.jsxs)(n.p,{children:["In this example, we added two options to the ",(0,s.jsx)(n.code,{children:"hello"})," command:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"newline"})," option is a boolean flag that will print each name on a separate line if provided."]}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"repeat"})," option is a number flag that will repeat the name n times if provided."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["We also swapped the ",(0,s.jsx)(n.code,{children:"name"})," positional argument for a ",(0,s.jsx)(n.code,{children:"people"})," array argument. This allows us to greet multiple people at once."]}),"\n",(0,s.jsx)(n.p,{children:"The new CLI can be invoked like this:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npx tsx bin/my-cli.ts hello --people john jane --newline --repeat 3\n"})}),"\n",(0,s.jsx)(n.h2,{id:"adding-subcommands",children:"Adding Subcommands"}),"\n",(0,s.jsx)(n.p,{children:"Subcommands are commands that are nested under another command. They allow you to group related commands together, and can be used to create complex CLI structures."}),"\n",(0,s.jsxs)(n.p,{children:["We've already been looking at subcommands as the ",(0,s.jsx)(n.code,{children:"hello"})," and ",(0,s.jsx)(n.code,{children:"goodbye"})," commands are subcommands of the root command, but they feel a bit different so we can look at a slightly more complex example."]}),"\n",(0,s.jsx)(n.p,{children:"Note options that are registered are valid for the command they are registered on, as well as any subcommands that are added to the command. Lets look at an example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { cli } from 'cli-forge';\n\ncli('my-cli')\n  .command('auth', {\n    builder: (args) =>\n      args\n        .option('host', { type: 'string', default: 'localhost' })\n        .command('login', {\n          builder: (args) => args.option('username', { type: 'string' }).option('password', { type: 'string' }),\n          handler: (args) => {\n            console.log('login', args.username, args.password);\n          },\n        })\n        .command('logout', {\n          handler: () => {\n            console.log('logout');\n          },\n        }),\n  })\n  .forge();\n"})}),"\n",(0,s.jsxs)(n.p,{children:["In this example, we added an ",(0,s.jsx)(n.code,{children:"auth"})," command with two subcommands: ",(0,s.jsx)(n.code,{children:"login"})," and ",(0,s.jsx)(n.code,{children:"logout"}),". The ",(0,s.jsx)(n.code,{children:"login"})," command takes two extra options: ",(0,s.jsx)(n.code,{children:"username"})," and ",(0,s.jsx)(n.code,{children:"password"}),", while the ",(0,s.jsx)(n.code,{children:"logout"})," command takes no additional options. The ",(0,s.jsx)(n.code,{children:"host"})," option is registered on the ",(0,s.jsx)(n.code,{children:"auth"})," command, and is available to all subcommands."]}),"\n",(0,s.jsx)(n.p,{children:"The new CLI can be invoked like this:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npx tsx bin/my-cli.ts auth login --username john --password secret\n"})}),"\n",(0,s.jsx)(n.h2,{id:"testing-your-cli",children:"Testing Your CLI"}),"\n",(0,s.jsx)(n.h3,{id:"manual-testing",children:"Manual Testing"}),"\n",(0,s.jsxs)(n.p,{children:["We've been testing our CLI manually by running it with ",(0,s.jsx)(n.code,{children:"npx tsx bin/my-cli.ts"}),". This is a good way to test your CLI as you are developing it, but it can be tedious to run the CLI manually every time you make a change to validate that it works as expected."]}),"\n",(0,s.jsx)(n.h3,{id:"automated-testing-unit-tests",children:"Automated Testing (Unit Tests)"}),"\n",(0,s.jsxs)(n.p,{children:["CLI Forge is no different from any other node compatible library, and can be tested using any testing framework you like. The examples within the docs use node's built-in ",(0,s.jsx)(n.code,{children:"assert"})," and ",(0,s.jsx)(n.code,{children:"test"})," modules, as they are available without any additional dependencies."]}),"\n",(0,s.jsxs)(n.p,{children:["CLI Forge provides a ",(0,s.jsx)(n.code,{children:"TestHarness"})," class that can be used to test how your CLI commands behave. It is recommended that to use this class to test how your arguments are parsed, but to extract the logic of your handlers into separate functions that can be tested independently."]}),"\n",(0,s.jsxs)(n.p,{children:["Here is an example of how you can test the ",(0,s.jsx)(n.code,{children:"hello"})," command from the previous example:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { TestHarness } from 'cli-forge';\n\nimport { describe, it } from 'node:test';\nimport * as assert from 'node:assert';\n\nimport { myCLI } from './my-cli';\n\nconst harness = new TestHarness(myCLI);\n\ndescribe('hello', () => {\n  it('should greet people', async () => {\n    const { args, commandChain } = await harness.parse(['hello', '--people', 'john', 'jane', '--newline']);\n    assert.deepStrictEqual(args.people, ['john', 'jane']);\n    assert.deepStrictEqual(args.newline, true);\n    assert.deepStrictEqual(commandChain, ['hello']);\n  });\n});\n"})}),"\n",(0,s.jsxs)(n.p,{children:["In this example, we are using the ",(0,s.jsx)(n.code,{children:"TestHarness"})," class to test the ",(0,s.jsx)(n.code,{children:"hello"})," command. We are testing that the ",(0,s.jsx)(n.code,{children:"people"})," argument is parsed correctly, that the ",(0,s.jsx)(n.code,{children:"newline"})," option is set to ",(0,s.jsx)(n.code,{children:"true"}),", and that the command chain is correct."]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"commandChain"})," is a representation of the command tree that was executed. E.g. ",(0,s.jsx)(n.code,{children:"['auth', 'login']"})," would be the command chain for the ",(0,s.jsx)(n.code,{children:"auth login"})," command."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"automated-testing-end-to-end-tests",children:"Automated Testing (End-to-End Tests)"}),"\n",(0,s.jsx)(n.p,{children:"End-to-end tests are a great way to test your CLI in a real-world scenario. They can be used to test how your CLI behaves when run from the command line, and can be used to test the output of your CLI."}),"\n",(0,s.jsxs)(n.p,{children:["If your CLI is going to be published to npm and ran via ",(0,s.jsx)(n.code,{children:"npx"}),", you can use a tool like ",(0,s.jsx)(n.code,{children:"verdaccio"})," to create a local npm registry to test your CLI in a real-world scenario."]}),"\n",(0,s.jsxs)(n.p,{children:["The exact setup for e2e is out of scope for this guide, but you can look at the ",(0,s.jsx)(n.code,{children:"e2e"})," directory in the CLI Forge repository for an example of how to set up e2e tests for your CLI."]})]})}function E(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(q,{...e})}):q(e)}},43023:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var s=t(63696);const i={},o=s.createContext(i);function r(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);